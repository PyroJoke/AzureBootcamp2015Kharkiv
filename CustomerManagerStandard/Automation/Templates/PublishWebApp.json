{
    "$schema": "http://schema.management.azure.com/schemas/2014-04-01-preview/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "dropLocation": {
            "type": "string",
            "metadata": {
                "visualStudio.deployment": { "parameterUsedAs": { "value": "dropLocation" } }
            }
        },
        "dropLocationSasToken": {
            "type": "securestring",
            "metadata": {
                "visualStudio.deployment": { "parameterUsedAs": { "value": "sasToken", "refersTo": "dropLocation" } }
            }
        },
        "webSitePackage": {
            "type": "string",
            "metadata": {
                "visualStudio.deployment": { "parameterUsedAs": { "value": "projectOutput" } }
            }
        },
        "webSiteName": {
            "type": "string"
        },
		"sqlServer": {
            "type": "string"
        },
		"sqlDatabase": {
            "type": "string"
        },
		"sqlUserName": {
            "type": "string"
        }.
		"sqlUserPassword": {
            "type": "string"
        }
    },
    "resources": [
		{
			"apiVersion": "2014-04-01-preview",
			"name": "[concat(parameters('webSiteName'), '/', 'MSDeploy')]",
			"type": "Microsoft.Web/sites/extensions",
			"properties": {
				"packageUri": "[concat(parameters('dropLocation'), '/', parameters('webSitePackage'), parameters('dropLocationSasToken'))]",
				"dbType": "2",
				"connectionString": "[concat('Data Source=tcp:', reference(concat('Microsoft.Sql/servers/', parameters('sqlServerName'))).fullyQualifiedDomainName, ',1433;Initial Catalog=', parameters('sqlDbName'), ';User Id=', parameters('sqlServerAdminLogin'), '@', parameters('sqlServerName'), ';Password=', parameters('sqlServerAdminPassword'), ';Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;')]",
				
				"setParameters": {
					"IIS Web Application Name": "[parameters('webSiteName')]"
				}
			}
		}
    ]
}
